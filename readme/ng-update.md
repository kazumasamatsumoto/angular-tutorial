了解しました！Angular の「ng update」の基本的な使い方と、バージョン 18 から 19 へアップデートする際の注意点について調査します。

「ng update」の基本コマンドや、使用方法の詳細、依存関係の管理方法について解説します。
また、Angular v18 から v19 へアップデートする際の推奨手順や、変更点、互換性に関する注意点、エラー対処方法などを整理してお伝えします。

調査が完了したら、詳細をお知らせします。

# Angular の「ng update」コマンドの基本と Angular v18 から v19 へのアップデート

## ng update コマンドの基本的な使い方

**ng update とは:** Angular CLI の`ng update`コマンドは、プロジェクトの依存パッケージを最新バージョンにアップデートし、必要に応じてコードの自動変換（マイグレーション）を行うためのコマンドです ([Angular プロジェクトのための Renovate 設定 | lacolaco's marginalia](https://blog.lacolaco.net/posts/renovate-config-for-angular-cli/#:~:text=,%E3%81%AF%E3%81%A8%E3%81%A6%E3%82%82%E9%87%8D%E8%A6%81%E3%81%AA%E5%BD%B9%E5%89%B2%E3%81%8C%E3%81%82%E3%82%8B%E3%80%82))。特に Angular 本体（@angular/core や@angular/cli）をメジャーバージョンアップする際に利用され、単にパッケージを更新するだけでなく**非推奨 API の置き換え**や**設定ファイルの更新**なども自動的に実施します ([Angular プロジェクトのための Renovate 設定 | lacolaco's marginalia](https://blog.lacolaco.net/posts/renovate-config-for-angular-cli/#:~:text=,%E3%81%AF%E3%81%A8%E3%81%A6%E3%82%82%E9%87%8D%E8%A6%81%E3%81%AA%E5%BD%B9%E5%89%B2%E3%81%8C%E3%81%82%E3%82%8B%E3%80%82))。これにより、開発者は手作業の修正を最小限に Angular の最新機能を取り込むことができます。

**主なコマンド例:** 一般的に Angular を最新の安定版にアップデートするには、プロジェクトのルートディレクトリで以下のように実行します（Angular CLI 自体とフレームワークコアを同時に指定します） ([ng update • Angular 日本語版](https://angular.jp/cli/update#:~:text=CLI%20by%20running%20the%20following,command)):

```bash
ng update @angular/cli @angular/core
```

上記コマンドは、現在のプロジェクトを Angular の最新安定版まで一括更新します ([ng update • Angular 日本語版](https://angular.jp/cli/update#:~:text=CLI%20by%20running%20the%20following,command))。特定のメジャーバージョン（例えば v19）へアップデートしたい場合は、パッケージ名にバージョン範囲を指定します ([ng update • Angular 日本語版](https://angular.jp/cli/update#:~:text=To%20update%20from%20one%20major,to%20another%2C%20use%20the%20format))。例えば Angular 19 系へ更新するには次のように実行します。

```bash
ng update @angular/cli@^19 @angular/core@^19
```

※この例では最新の 19.x.x 系に更新します ([ng update • Angular 日本語版](https://angular.jp/cli/update#:~:text=To%20update%20from%20one%20major,to%20another%2C%20use%20the%20format))（`@latest`タグ指定や`^19`指定により、19 系の最新パッチ版が適用されます）。

**主要なオプション:** `ng update`にはいくつか便利なオプションがあります。主なものを以下にまとめます。

| オプション                | 説明                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| ------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `--next`                  | 次のベータ版やリリース候補（RC）版にアップデートします ([ng update • Angular](https://angular.dev/cli/update#:~:text=ng%20update%20%40angular%2Fcli%20%40angular%2Fcore))。                                                                                                                                                                                                                                                                                                                  |
| `--allow-dirty`           | Git リポジトリに未コミットまたは未管理の変更があってもアップデートを許可します ([typescript - Repository is not clean. Please commit or stash any changes before updating In Angular 8 - Stack Overflow](https://stackoverflow.com/questions/56773528/repository-is-not-clean-please-commit-or-stash-any-changes-before-updating-in-a#:~:text=I%27ve%20had%20the%20same%20issue,bypass%20this%2C%20follow%20force%20commands))（通常、**「リポジトリがクリーンでない」**エラー回避に使用）。 |
| `--force`                 | ピア依存関係のバージョン不整合を無視して強制的にアップデートします ([typescript - Repository is not clean. Please commit or stash any changes before updating In Angular 8 - Stack Overflow](https://stackoverflow.com/questions/56773528/repository-is-not-clean-please-commit-or-stash-any-changes-before-updating-in-a#:~:text=I%20have%20tried%20using%20mention,was%20still%20getting%20the%20error))（依存関係の制約でブロックされる場合に使用。ただし副作用に注意）。                 |
| `--create-commits` (`-C`) | アップデートやマイグレーションごとに Git コミットを自動作成します ([ng update • Angular](https://angular.dev/cli/update#:~:text=%60create))。変更履歴を追跡したいときに便利です。                                                                                                                                                                                                                                                                                                            |
| `--migrate-only`          | パッケージのバージョンは変更せず、マイグレーションスクリプト（コード変換）のみ実行します ([ng update • Angular](https://angular.dev/cli/update#:~:text=Value%20Type%20))。`--from`/`--to`オプションと併用して特定バージョン間の変換だけを適用できます。                                                                                                                                                                                                                                      |

**使用する場面:** `ng update`は、Angular のフレームワーク自体や Angular CLI、Angular Material など**Angular 公式パッケージを新しいメジャー/マイナー版に上げるとき**に主に使います。例えば「Angular 18 から 19 へ上げたい」「Angular 18.x の最新パッチに上げたい」といった場合です。加えて、Angular と連携する一部のサードパーティライブラリ（NgRx や Angular Firebase など）も`ng update`用のスケマティックを提供している場合があり、その際は同様に `ng update パッケージ名` で対応するライブラリのアップデートと自動修正を行えます。通常、**メジャーバージョンアップや重要なマイナーアップデート**では`ng update`による自動移行が推奨されており、パッチレベルのアップデート（バグ修正のみ）では単純な依存関係更新でも問題ない場合があります ([Angular プロジェクトのための Renovate 設定 | lacolaco's marginalia](https://blog.lacolaco.net/posts/renovate-config-for-angular-cli/#:~:text=,%E3%81%AF%E3%81%A8%E3%81%A6%E3%82%82%E9%87%8D%E8%A6%81%E3%81%AA%E5%BD%B9%E5%89%B2%E3%81%8C%E3%81%82%E3%82%8B%E3%80%82)) ([Angular プロジェクトのための Renovate 設定 | lacolaco's marginalia](https://blog.lacolaco.net/posts/renovate-config-for-angular-cli/#:~:text=%E3%81%A0%E3%81%8C%E3%81%93%E3%82%8C%E3%82%89%E3%81%AE%E3%83%91%E3%83%83%E3%82%B1%E3%83%BC%E3%82%B8%E3%81%A7%E3%82%82%E3%81%99%E3%81%B9%E3%81%A6%E3%81%AE%E3%83%90%E3%83%BC%E3%82%B8%E3%83%A7%E3%83%B3%E3%81%AB%E8%87%AA%E5%8B%95%E3%83%9E%E3%82%A4%E3%82%B0%E3%83%AC%E3%83%BC%E3%82%B7%E3%83%A7%E3%83%B3%E3%81%8C%E5%90%AB%E3%81%BE%E3%82%8C%E3%82%8B%E3%82%8F%E3%81%91%E3%81%A7%E3%81%AF%E3%81%AA%E3%81%84%E3%80%82%20Angular%20%E5%85%AC%E5%BC%8F%E3%83%91%E3%83%83%E3%82%B1%E3%83%BC%E3%82%B8%E3%81%AE%E5%A0%B4%E5%90%88%E3%80%81,%E3%81%A4%E3%81%BE%E3%82%8A%E3%80%81%E3%83%91%E3%83%83%E3%83%81%E3%83%90%E3%83%BC%E3%82%B8%E3%83%A7%E3%83%B3%E3%82%A2%E3%83%83%E3%83%97%E3%81%AE%E3%81%A8%E3%81%8D%E3%81%AF%20Renovate%20%E3%82%92%E4%BD%BF%E3%81%A3%E3%81%A6%E6%9B%B4%E6%96%B0%E3%81%97%E3%81%A6%E5%95%8F%E9%A1%8C%E3%81%AA%E3%81%84%E3%80%82))。

**依存関係の更新とマイグレーション:** `ng update`を実行すると、該当パッケージ（例: `@angular/core`）およびそれに関連するパッケージ群をまとめて更新します ([Angular プロジェクトのための Renovate 設定 | lacolaco's marginalia](https://blog.lacolaco.net/posts/renovate-config-for-angular-cli/#:~:text=,%E3%81%AF%E3%81%A8%E3%81%A6%E3%82%82%E9%87%8D%E8%A6%81%E3%81%AA%E5%BD%B9%E5%89%B2%E3%81%8C%E3%81%82%E3%82%8B%E3%80%82))。例えば Angular 本体を更新する場合、`@angular/core`だけでなく`@angular/common`や`@angular/compiler`、必要に応じて`rxjs`や`zone.js`、TypeScript のバージョンまで含めて適切な組み合わせにアップデートされます ([Angular プロジェクトのための Renovate 設定 | lacolaco's marginalia](https://blog.lacolaco.net/posts/renovate-config-for-angular-cli/#:~:text=,%E3%81%AF%E3%81%A8%E3%81%A6%E3%82%82%E9%87%8D%E8%A6%81%E3%81%AA%E5%BD%B9%E5%89%B2%E3%81%8C%E3%81%82%E3%82%8B%E3%80%82)) ([Version compatibility • Angular](https://angular.dev/reference/versions#:~:text=Angular%20Node,7.4.0))。さらに、アップデート時には自動的に**マイグレーションスクリプト**が実行され、古いバージョンで非推奨になった設定やコードが新しい書き方に置き換えられます ([Angular プロジェクトのための Renovate 設定 | lacolaco's marginalia](https://blog.lacolaco.net/posts/renovate-config-for-angular-cli/#:~:text=,%E3%81%AF%E3%81%A8%E3%81%A6%E3%82%82%E9%87%8D%E8%A6%81%E3%81%AA%E5%BD%B9%E5%89%B2%E3%81%8C%E3%81%82%E3%82%8B%E3%80%82))。たとえば、`angular.json`から不要になった項目を削除したり、将来的に削除される予定の API 呼び出しを新しい API に書き換えるといった処理が行われます ([Angular プロジェクトのための Renovate 設定 | lacolaco's marginalia](https://blog.lacolaco.net/posts/renovate-config-for-angular-cli/#:~:text=,%E3%81%AF%E3%81%A8%E3%81%A6%E3%82%82%E9%87%8D%E8%A6%81%E3%81%AA%E5%BD%B9%E5%89%B2%E3%81%8C%E3%81%82%E3%82%8B%E3%80%82))。この自動マイグレーションによって、開発者は**手作業での大規模な書き換え**をせずに安全にアップグレードできます。なお、`ng update`実行後には変更点の差分を確認し、アプリケーションが正しく動作するかテストすることが重要です ([Angular プロジェクトのための Renovate 設定 | lacolaco's marginalia](https://blog.lacolaco.net/posts/renovate-config-for-angular-cli/#:~:text=,%E3%81%AF%E3%81%A8%E3%81%A6%E3%82%82%E9%87%8D%E8%A6%81%E3%81%AA%E5%BD%B9%E5%89%B2%E3%81%8C%E3%81%82%E3%82%8B%E3%80%82))。

**よくあるエラーと対処法:** `ng update`コマンドを利用する際に遭遇しやすいエラーとその対処法をいくつか紹介します。

- **「Repository is not clean (リポジトリがクリーンでない)」エラー:** アップデート実行時に未コミットの変更があると、このエラーで処理が停止します。対処法は**変更をコミットまたはスタッシュ**してから再実行することです。どうしてもコミットせずに進めたい場合は、上記の`--allow-dirty`オプションで強行できます ([typescript - Repository is not clean. Please commit or stash any changes before updating In Angular 8 - Stack Overflow](https://stackoverflow.com/questions/56773528/repository-is-not-clean-please-commit-or-stash-any-changes-before-updating-in-a#:~:text=I%27ve%20had%20the%20same%20issue,bypass%20this%2C%20follow%20force%20commands))が、アップデート後に問題が発生しないか十分注意してください。

- **ピア依存関係の競合によるエラー:** 特定のライブラリが要求する Angular のバージョン制約に抵触する場合、`ng update`がブロックされることがあります（例：「requires a peer of @angular/core <18 but 19 found」のようなメッセージ）。この場合、まずそのライブラリ（またはその新バージョン）が Angular 最新版をサポートしているか確認しましょう。対応版が存在するなら一緒にアップデートし、不明な場合一時的に`--force`オプションで強制アップデートする方法もあります ([typescript - Repository is not clean. Please commit or stash any changes before updating In Angular 8 - Stack Overflow](https://stackoverflow.com/questions/56773528/repository-is-not-clean-please-commit-or-stash-any-changes-before-updating-in-a#:~:text=I%20have%20tried%20using%20mention,was%20still%20getting%20the%20error))。【※注意】`--force`での強制アップデート後は、該当ライブラリが正常に動作するかテストし、必要なら代替ライブラリへの移行を検討してください。

- **グローバル CLI のバージョン不一致:** 開発マシンにグローバルインストールされた Angular CLI のバージョンと、プロジェクト内の CLI バージョンが大きく異なると、コマンド実行時に警告が出たり不整合が生じることがあります。アップデート前後にはグローバルの Angular CLI も最新に更新しておくことが推奨されます（例: `npm install -g @angular/cli@19` 等）。こうすることでローカルプロジェクトとコマンドの互換性を保てます。

- **その他のエラー:** アップデート途中でネットワークエラーやメモリエラーが起きた場合、再度`ng update`を実行すれば途中から続行されます。依存関係解決の不具合で失敗する場合は、一度`node_modules`を削除して`npm install`し直す、`npm cache clean`するなど環境を整えてから再挑戦してください。アップデート完了後にビルドエラーが発生する場合は、CLI が出力した**Breaking Changes（破壊的変更）に関するメッセージ**や Angular 公式の変更ログを確認し、それに従ってコード修正を行います。例えば、Angular のアップデートに伴い型定義が厳密化されてエラーになった場合は型注釈を追加する、不要になった polyfills のインポートが削除された場合はコードから参照を外す、といった対応をします。

以上が`ng update`コマンドの基本的な使い方と注意点です。次に、具体的に**Angular v18 から v19 へのアップデート**手順と変更点について詳しく見ていきます。

## Angular v18 から v19 へのアップデート

### 推奨されるアップデート手順

Angular v18 から v19 へバージョンアップする際は、以下の手順で進めることが推奨されます。

1. **公式情報の確認とバックアップ:** まず Angular 公式のリリースノートやアップデートガイドを確認し、変更点や注意事項を把握します。重要なプロジェクトであれば事前にソースコードのバックアップや Git ブランチの作成を行い、いつでも元の状態に戻せるようにしておきます。

2. **Angular CLI の更新:** 開発環境にインストールされている**Angular CLI（グローバル）を最新バージョン(v19 系)に更新**します。例えば npm を利用している場合、`npm install -g @angular/cli@19` を実行します（Linux/macOS 環境では先頭に`sudo`が必要な場合があります）。これにより、新バージョン用のコマンドが利用可能になります。

3. **プロジェクトの依存関係更新:** プロジェクトディレクトリに移動し、Angular 本体と CLI を v19 へアップデートします。具体的には以下のコマンドを実行してください ([Guide to update your Angular application v18.0](https://angular.dev/update-guide?v=18.0-19.0&l=1#:~:text=In%20the%20application%27s%20project%20directory%2C,Angular%20directives))。

   ```bash
   ng update @angular/core@19 @angular/cli@19
   ```

   CLI が新バージョンのパッケージをインストールし、続いてマイグレーションスクリプトが自動的に走ります。実行中にいくつか質問プロンプトが表示される場合があります。内容を確認し、必要に応じて`Yes/Y`で変更を適用してください。**（※ヒント:** エラーが発生した場合は前述の対処法セクションを参照してください。）

4. **関連パッケージの更新:** Angular Material や Angular CDK 等、Angular 公式の追加ライブラリを利用している場合は、対応する v19 版へアップデートします。例えば Material を使っている場合、上記コマンドに続けて`ng update @angular/material@19 @angular/cdk@19`を実行します。その他、フォームや言語サービスなど個別にインストールしている Angular パッケージ（例: `@angular/forms`や`@angular/localize`）があれば、それらも package.json のバージョンを確認し必要に応じて更新してください。**RxJS**については、Angular 19 は RxJS 7 系との後方互換を保ちつつ、RxJS 8 もサポートしています ([Version compatibility • Angular](https://angular.dev/reference/versions#:~:text=Angular%20Node,7.4.0))。RxJS 8 を利用したい場合は`npm install rxjs@^8`で手動更新できますが、既存コードとの互換性に注意してください。

5. **ビルドとテストの実行:** 依存関係の更新が完了したら、`ng serve`や`ng build`でアプリケーションが正しくビルド・起動できるか確認します。併せて`ng test`で単体テストがすべて通ることを確認してください。特に大きな変更があった部分（後述の変更点を参照）の周辺は重点的に動作確認します。

6. **追加のマイグレーションや手動修正:** Angular アップデートによって非推奨 API の置換などは自動で行われますが、新しい推奨手法への移行が**オプショナル（任意）**になっている箇所もあります。例えば、v19 で安定版となった**Signal ベースの@Input/@Output やクエリ**にコードを書き換えたい場合、以下の専用スクリプトを手動で実行できます ([Meet Angular v19. In the past two years we doubled down… | by Minko Gechev | Angular Blog](https://blog.angular.dev/meet-angular-v19-7b29dfd05b84#:~:text=Over%20the%20past%20year%2C%20we,to%20stable%21%20To%20simplify%20the)) ([Meet Angular v19. In the past two years we doubled down… | by Minko Gechev | Angular Blog](https://blog.angular.dev/meet-angular-v19-7b29dfd05b84#:~:text=introducing%20a%20new%20experimental%20,think%20of%20a%20resource%20as))。

   ```bash
   # @Input()をSignalベースのInputに変換
   ng generate @angular/core:signal-input-migration

   # @ViewChild等のクエリをSignalベースに変換
   ng generate @angular/core:signal-queries-migration

   # 従来のEventEmitter出力を新しい出力APIに変換
   ng generate @angular/core:output-migration
   ```

   上記は必要な場合のみ実行します。また、アップデートガイドに「手動で対応が必要」と記載された項目（**Breaking Changes**）があれば、その指示に従いコード修正を行ってください。作業が完了したら改めてビルド・テストを行い、**アップデート前と同じ機能が正常に動作すること**を確認しましょう。

### Angular v19 の主要な変更点と新機能

Angular 19 は、開発者体験とパフォーマンスの向上を主眼に、数多くの新機能や改良が盛り込まれています ([Meet Angular v19. In the past two years we doubled down… | by Minko Gechev | Angular Blog](https://blog.angular.dev/meet-angular-v19-7b29dfd05b84#:~:text=,addressing%20feature%20requests%20with%20more)) ([Meet Angular v19. In the past two years we doubled down… | by Minko Gechev | Angular Blog](https://blog.angular.dev/meet-angular-v19-7b29dfd05b84#:~:text=,HMR%20for%20styles%2C%20and%20more))。v18 から v19 へのアップデートで特に注目すべき主要ポイントをまとめます。

- **SSR 性能の強化（インクリメンタル・ハイドレーション他）:** サーバサイドレンダリング(SSR)を利用するアプリ向けに大幅な最適化が行われました。まず**インクリメンタル・ハイドレーション**（incremental hydration）の開発者プレビューが導入され、テンプレート内で`@defer`ディレクティブを付けた部分をユーザーの操作に応じて**遅延読み込み・段階的にハイドレーション**できるようになりました ([What's New in Angular 19: Top Features and Updates](https://www.unifiedinfotech.net/blog/angular-19-new-features-a-steady-step-forward-or-just-another-update/#:~:text=1)) ([What's New in Angular 19: Top Features and Updates](https://www.unifiedinfotech.net/blog/angular-19-new-features-a-steady-step-forward-or-just-another-update/#:~:text=Angular%2019%20brings%20incremental%20hydration%2C,and%20clicking%20of%20user%20interactions))。これにより初期ロード時の不要な JS 実行を減らし、ページの初期表示を高速化できます。また**ルート単位のレンダリングモード設定**が追加され、各ルート（ページ）ごとに「サーバでレンダリングする」「ビルド時にプリレンダリングする」「クライアント側（SPA として）処理する」を選択可能になりました ([What's New in Angular 19: Top Features and Updates](https://www.unifiedinfotech.net/blog/angular-19-new-features-a-steady-step-forward-or-just-another-update/#:~:text=In%20earlier%20versions%20of%20Angular,each%20individual%20route%20is%20rendered)) ([What's New in Angular 19: Top Features and Updates](https://www.unifiedinfotech.net/blog/angular-19-new-features-a-steady-step-forward-or-just-another-update/#:~:text=,handled%20on%20the%20client%20side))。新しい`ServerRoute`ツールを使い、SSR すべきルートとそうでないルートをきめ細かく制御できます ([What's New in Angular 19: Top Features and Updates](https://www.unifiedinfotech.net/blog/angular-19-new-features-a-steady-step-forward-or-just-another-update/#:~:text=In%20earlier%20versions%20of%20Angular,each%20individual%20route%20is%20rendered))。さらに、SSR 時のユーザー操作を損ねないよう**イベント・リプレイ（Event Replay）**機能がデフォルトで有効化されました ([Meet Angular v19. In the past two years we doubled down… | by Minko Gechev | Angular Blog](https://blog.angular.dev/meet-angular-v19-7b29dfd05b84#:~:text=In%20version%2019%2C%20we%E2%80%99re%20elevating,enabled%20by%20default%2C%20and%20more))。これは、SSR ページでユーザーがハイドレーション完了前に行ったクリック等のイベントを一旦キャプチャしておき、必要なスクリプト読み込み後に遅延実行する仕組みです ([What's New in Angular 19: Top Features and Updates](https://www.unifiedinfotech.net/blog/angular-19-new-features-a-steady-step-forward-or-just-another-update/#:~:text=During%20the%20Angular%20development%20lifecycle%2C,noticeable%20lags%20in%20response%20time)) ([What's New in Angular 19: Top Features and Updates](https://www.unifiedinfotech.net/blog/angular-19-new-features-a-steady-step-forward-or-just-another-update/#:~:text=The%20newest%20Angular%2019%20version,the%20required%20code%20is%20available))。これら SSR 周りの新機能（インクリメンタル・ハイドレーション、ルート毎の SSR 制御、イベントリプレイ）により、**初期表示の体感速度向上**と**サーバレンダリング時の操作レスポンス改善**が期待できます ([Angular v19 Released: Top Features and Updates](https://www.angularminds.com/blog/angular-19-features#:~:text=Angular%20is%20now%20focusing%20on,enabled%20by%20default%2C%20and%20more)) ([Angular v19 Released: Top Features and Updates](https://www.angularminds.com/blog/angular-19-features#:~:text=incremental%20hydration%20for%20SSR%2C%20allowing,enabled%20by%20default%2C%20and%20more))。

- **リアクティブプログラミング（Signals）の強化:** v16 以降プレビュー段階だった**Angular Signals**が、v19 でさらに強化・安定化されました。まず**シグナルベースの@Input/@Output、ViewChild/ContentChild 等のクエリ**API が安定版（stable）となり、正式に利用可能になりました ([Meet Angular v19. In the past two years we doubled down… | by Minko Gechev | Angular Blog](https://blog.angular.dev/meet-angular-v19-7b29dfd05b84#:~:text=Stabilization%20of%20inputs%2C%20outputs%2C%20and,view%20queries)) ([Meet Angular v19. In the past two years we doubled down… | by Minko Gechev | Angular Blog](https://blog.angular.dev/meet-angular-v19-7b29dfd05b84#:~:text=You%20can%20read%20more%20about,view%20queries%20in%20our%20documentation))。Signal 入力は従来の@Input と異なり**読み取り専用**になる（親から渡された Signal を子コンポーネント側で書き換え不可）点に留意が必要です ([Meet Angular v19. In the past two years we doubled down… | by Minko Gechev | Angular Blog](https://blog.angular.dev/meet-angular-v19-7b29dfd05b84#:~:text=match%20at%20L385%20Note%20that,if%20you%E2%80%99re%20setting%20input%20values))。また、新たに**`linkedSignal`**というプリミティブが追加されています。`linkedSignal`は**他の Signal に依存する可変状態**を簡潔に表現するための API で、例えば選択肢リストに基づいて現在の選択項目を表す Signal を自動的に連動させるケースなどで役立ちます ([What's New in Angular 19: Top Features and Updates](https://www.unifiedinfotech.net/blog/angular-19-new-features-a-steady-step-forward-or-just-another-update/#:~:text=3)) ([What's New in Angular 19: Top Features and Updates](https://www.unifiedinfotech.net/blog/angular-19-new-features-a-steady-step-forward-or-just-another-update/#:~:text=Angular%2019%20also%20introduces%20a,the%20list%20of%20options%20changes))。従来は`effect`で実装していた「依存 Signal の変化に追随して値をリセットする」ようなパターンが、linkedSignal によりシンプルに記述可能になります ([Meet Angular v19. In the past two years we doubled down… | by Minko Gechev | Angular Blog](https://blog.angular.dev/meet-angular-v19-7b29dfd05b84#:~:text=match%20at%20L430%20,advanced%20API%20which%20allows%20for))。さらに**`resource` API**（実験的機能）が導入されました。`resource()`は**非同期処理の結果を Signal と統合して扱うための仕組み**で、Promise や Observable から得た非同期データを直接シグナルの一部として扱えるようになります ([Meet Angular v19. In the past two years we doubled down… | by Minko Gechev | Angular Blog](https://blog.angular.dev/meet-angular-v19-7b29dfd05b84#:~:text=signals%2C%20computed%20values%2C%20inputs%2C%20queries%2C,think%20of%20a%20resource%20as))。これにより、HTTP リクエストなどの結果を Signals リアクティブシステムにスムーズに取り込めるようになります。総じて Angular 19 では、Signals を用いたリアクティブプログラミングが一段と実用的になり、今後の Angular アプリ開発の選択肢として本格的に利用できるようになりました ([Meet Angular v19. In the past two years we doubled down… | by Minko Gechev | Angular Blog](https://blog.angular.dev/meet-angular-v19-7b29dfd05b84#:~:text=,addressing%20feature%20requests%20with%20more))。

- **開発体験の改善（Tooling 強化）:** 開発効率を上げるための数々の改善も盛り込まれています。まず Angular CLI の**新しいビルドシステム**がプレビュー段階で利用可能です。これは内部的に esbuild や Vite を採用したビルダーで、既存の Webpack ベースビルドよりビルド・リビルド速度が向上します ([Meet Angular v19. In the past two years we doubled down… | by Minko Gechev | Angular Blog](https://blog.angular.dev/meet-angular-v19-7b29dfd05b84#:~:text=move%20to%20the%20new%20esbuild,specific%20features%20like%20file))。v19 では Karma 経由のユニットテストでもこの新ビルダーを試せるようになり（`angular.json`で`builderMode`を設定）、テスト実行時間も短縮されます ([Meet Angular v19. In the past two years we doubled down… | by Minko Gechev | Angular Blog](https://blog.angular.dev/meet-angular-v19-7b29dfd05b84#:~:text=move%20to%20the%20new%20esbuild,specific%20features%20like%20file))。また**ホットモジュールリプレース（HMR）の強化**も行われ、スタイルやテンプレートの変更時にページ全体のリロード無しで即座に反映されるようになりました ([What's New in Angular 19: Top Features and Updates](https://www.unifiedinfotech.net/blog/angular-19-new-features-a-steady-step-forward-or-just-another-update/#:~:text=6)) ([What's New in Angular 19: Top Features and Updates](https://www.unifiedinfotech.net/blog/angular-19-new-features-a-steady-step-forward-or-just-another-update/#:~:text=Hot%20module%20replacement%20in%20Angular,page%20refresh))。従来は HMR でも CSS や HTML の変更でフルリロードが発生していましたが、v19 では状態を保持したまま部分的に更新できるため、フロントエンド開発のライブプレビューが快適になります ([What's New in Angular 19: Top Features and Updates](https://www.unifiedinfotech.net/blog/angular-19-new-features-a-steady-step-forward-or-just-another-update/#:~:text=6))。さらに**Angular Language Service(言語サービス)**と CLI スケマティックの連携により、コードエディタ上で自動マイグレーションを提案・適用する機能が追加されました ([What's New in Angular 19: Top Features and Updates](https://www.unifiedinfotech.net/blog/angular-19-new-features-a-steady-step-forward-or-just-another-update/#:~:text=5,Language%20Service))。たとえば旧来の構文で書かれた@Input や@ViewChild にカーソルを当てると、エディタ内で最新 API への変換を適用できるなど、アップデート作業を支援してくれます ([What's New in Angular 19: Top Features and Updates](https://www.unifiedinfotech.net/blog/angular-19-new-features-a-steady-step-forward-or-just-another-update/#:~:text=5,Language%20Service))。他にも、不要インポートの自動削除や、Angular チーム公式コンポーネントとして**タイムピッカー(UI 用時間入力)コンポーネント**の追加など、多数の開発者要望に応える改良が含まれています ([Meet Angular v19. In the past two years we doubled down… | by Minko Gechev | Angular Blog](https://blog.angular.dev/meet-angular-v19-7b29dfd05b84#:~:text=,HMR%20for%20styles%2C%20and%20more))。

- **その他の変更点:** デフォルト設定や実験的機能にもいくつか変更があります。Angular 19 では新規プロジェクト作成時に**Standalone コンポーネント**がデフォルト有効となりました ([What's New in Angular 19: Top Features and Updates](https://www.unifiedinfotech.net/blog/angular-19-new-features-a-steady-step-forward-or-just-another-update/#:~:text=7))。`ng new`で生成されるコンポーネントは自動的に`standalone: true`付きとなり、NgModule への宣言を省略できます。既存の NgModule ベースのプロジェクトがただちに影響を受けることはありませんが、将来的には Standalone が主流になる方向性です ([Angular Blog](https://blog.angular.dev/#:~:text=Angular%20Blog%20The%20future%20is,for%20components%2C%20directives%2C%20and%20pipes))。また**ゾーンレス変更検出**の実験機能が引き続き提供されています ([What's New in Angular 19: Top Features and Updates](https://www.unifiedinfotech.net/blog/angular-19-new-features-a-steady-step-forward-or-just-another-update/#:~:text=8))（v19 でもデフォルトは Zone.js 有効ですが、将来に向けたパフォーマンス改善策として注目されています）。テスト面では、Jest との互換性向上や Angular TestBed のパフォーマンス改善など内部的な調整が行われています ([What's New in Angular 19: Top Features and Updates](https://www.unifiedinfotech.net/blog/angular-19-new-features-a-steady-step-forward-or-just-another-update/#:~:text=9))。セキュリティ面でも Google による定期的なセキュリティ監査を通じた堅牢性向上が継続されています ([What's New in Angular 19: Top Features and Updates](https://www.unifiedinfotech.net/blog/angular-19-new-features-a-steady-step-forward-or-just-another-update/#:~:text=10))。これら多数の変更点の詳細については、公式ブログの「Meet Angular v19」記事などに詳しくまとめられています ([Meet Angular v19. In the past two years we doubled down… | by Minko Gechev | Angular Blog](https://blog.angular.dev/meet-angular-v19-7b29dfd05b84#:~:text=,addressing%20feature%20requests%20with%20more)) ([Meet Angular v19. In the past two years we doubled down… | by Minko Gechev | Angular Blog](https://blog.angular.dev/meet-angular-v19-7b29dfd05b84#:~:text=,HMR%20for%20styles%2C%20and%20more))。

### 互換性の注意点

Angular 18 から 19 へのアップデートに際して留意すべき互換性事項を整理します。

- **開発環境の要件:** Angular v19 を使用するには、Node.js や TypeScript のバージョンが適合している必要があります。Angular 公式の対応表によると、Angular 19 は少なくとも Node.js 18.19.1 以降（もしくは Node 20 以降）を要求します ([Version compatibility • Angular](https://angular.dev/reference/versions#:~:text=Angular%20Node,7.4.0))。また TypeScript は 5.5 以上 5.8 未満（5.5.x〜5.7.x）をサポート範囲としており ([Version compatibility • Angular](https://angular.dev/reference/versions#:~:text=Angular%20Node,7.4.0))、これより古い TypeScript でコンパイルすると型エラーが発生する可能性があります。アップデート時に CLI が自動的に適切なバージョンに上げてくれますが、事前に Node や TS のアップデートが必要な場合は適宜対応してください。

- **依存ライブラリの互換性:** プロジェクト内で使用しているサードパーティ製の Angular ライブラリがある場合、そのライブラリが Angular 19 に対応しているか確認が必要です。多くの主要ライブラリ（NgRx や ngx-bootstrap 等）は Angular 新バージョンリリースに合わせてアップデートを提供しますが、対応版リリースが遅れる場合もあります。その際は一時的にそのライブラリを外してアップデートを行い、後日対応版が出たら再導入する、といった戦略も考えられます。`ng update`実行時に peer dependency 警告が出たものについては、可能な限りアップデート直後に対応版へ入れ替えるか、最低でもビルドや CI で問題が起きないことを確認してください。

- **Signals 関連 API の選択:** 前述の通り v19 で Signals 系 API が安定化しましたが、**従来の変更検出とテンプレートバインディングは引き続き有効**であり、アップデートによって既存コードが強制的に Signals に書き換わることはありません。したがって、開発チームの判断で必要性が高まった時に段階的に Signals を導入すればよく、当面は既存の`@Input()`/`@Output()`や RxJS によるデータフローはそのまま動作します。将来的なメジャーアップデートで古い手法が非推奨・削除される可能性はありますが、Angular は通常 2 バージョン以上前から非推奨警告を出す方針のため、v19 への直接のアップデートで既存 API が突然使えなくなる心配はありません。

- **ビルド設定の変更:** Angular 19 への更新時に、`angular.json`などのプロジェクト設定ファイルに自動変更が入る場合があります。例えば古くから存在した**`polyfills.ts`の読み込み設定が削除**され、Angular CLI 自体が必要なポリフィルを内部で管理するようになります（v18 以前から徐々に進んでいた変更です）。同様に、将来的に不要となる設定項目が除去・変更されることがありますが、`ng update`がその差分を示してくれるので、必要に応じてプロジェクト固有のカスタマイズを追従させてください。もし過去にカスタム Webpack 設定や特殊なビルドフローを組んでいる場合は、新しいビルドシステムとの互換性を検証することも忘れずに。

- **フォーム・バリデーションやその他コア API:** Angular 本体のコア API について、v19 で非推奨になったものや挙動が変わったものは公式には「破壊的変更(Breaking Changes)」としてアナウンスされます。v19 では大きな破壊的変更は多くないものの、**Strict モードでのフォーム制御**や**i18n 周り**で警告レベルの変更が入っている可能性があります。アップデート後にコンパイルエラーやコンソール警告が出た場合、それは互換性に関する何らかの変更を示しています。エラーメッセージや警告メッセージ中のリンク（通常【...angular.dev/errors/～】の形式）をクリックすると詳細な説明と対処法が表示されます ([After update to version 19 tests not working · Issue #58749 · angular/angular · GitHub](https://github.com/angular/angular/issues/58749#:~:text=,dev%2Ferrors%2FNG0950))。コードの該当箇所をその説明に従って修正することで、互換性問題を解消できます。

### よく発生する問題とその解決策

Angular 18 から 19 へのアップデート後に開発者が直面しがちな問題と、その対処法をいくつか紹介します。

- **単体テストの失敗（必須 Input のエラー）:** アップデート後に単体テストを実行すると、コンポーネントの**@Input に値が設定されていないことを検出するエラー（NG0950）**が発生する場合があります ([After update to version 19 tests not working · Issue #58749 · angular/angular · GitHub](https://github.com/angular/angular/issues/58749#:~:text=,dev%2Ferrors%2FNG0950))。これは Angular が Input プロパティに`required`フラグを付けられる機能を導入し、未設定の必須 Input を検知するようになったためです。開発環境ではこのチェックが有効になるため、テストで`TestBed.createComponent`しただけでは必須 Input が供給されずエラーになります。対策として、該当コンポーネントのテストケース内で`component.inputProp = 値;`を設定してから`fixture.detectChanges()`を呼ぶか、Input を必須でない扱いに変更します（デコレーター引数で`required: false`にするか、型を`undefined`許容にする等）。こうした変更によりテストを修正し、再度実行してください。

- **スタイルのちらつき（Flicker）問題:** SSR 有効アプリケーションで Angular 19 に上げた後、ページ遷移時にスタイルが一瞬当たらない「ちらつき」が発生するとの報告があります ([Angular 19: Issue with Style Flickering When Switching Views (ng ...](https://github.com/angular/angular/issues/59058#:~:text=Angular%2019%3A%20Issue%20with%20Style,styles%20of%20a%20specific%20component))。これはおそらく新しいハイドレーションや HMR 周りのバグまたは挙動の変化によるものです。最新の Angular 19.x パッチにアップデートすることで解消する可能性があります（Angular は頻繁にマイナーバージョン内で不具合修正をリリースします）。それでも問題が続く場合、一時的な回避策として特定の CSS を強制適用するスクリプトを挿入することも考えられますが、まずは公式の Issue Tracker やコミュニティで同様の不具合が報告されていないか確認してください。

- **パフォーマンス・サイズの変化:** Angular のアップデートによってビルド後のバンドルサイズや動作パフォーマンスに変化が生じることがあります。一般的に新バージョンでは最適化が進みサイズ縮小・高速化する傾向にありますが、逆に一時的にバンドルがわずかに大きくなるケースもありえます。これは新機能や polyfill の追加によるものですが、不要な機能をオプトアウトできる設定が提供されている場合があります。アップデート後にパフォーマンスプロファイリングを行い、問題があれば Angular 公式ドキュメントのパフォーマンスガイドに従って調整を検討してください。

- **その他**: アップデート直後にビルドエラーが出た場合、エラーメッセージから原因箇所を特定し対応します。例えば「NG3003: ～ is not a known element」というエラーが出れば、Standalone 化の影響で適切な`imports`が不足している可能性があります。そのコンポーネントのテストやモジュール定義に必要なモジュール/コンポーネントを追加してください。依然として解決しない問題がある場合、Angular 公式のアップデートガイド ([Meet Angular v19. In the past two years we doubled down… | by Minko Gechev | Angular Blog](https://blog.angular.dev/meet-angular-v19-7b29dfd05b84#:~:text=,addressing%20feature%20requests%20with%20more))やコミュニティフォーラム（Stack Overflow や Github の Issues）を検索し、同様のケースと対策を調べると良いでしょう。

以上、Angular の`ng update`コマンドの基本と、v18 から v19 へのアップデートに関する詳細を解説しました。公式ドキュメントやコミュニティの情報を参考にしつつ慎重にアップデートを進めれば、最新の Angular 19 の新機能 ([Meet Angular v19. In the past two years we doubled down… | by Minko Gechev | Angular Blog](https://blog.angular.dev/meet-angular-v19-7b29dfd05b84#:~:text=,addressing%20feature%20requests%20with%20more))を活用した開発体験とパフォーマンス向上を得られるはずです。ぜひバックアップを取りつつ段階的に試してみてください。

**参考資料:**

- Angular 公式: CLI リファレンス - ng update ([ng update • Angular 日本語版](https://angular.jp/cli/update#:~:text=CLI%20by%20running%20the%20following,command)) ([ng update • Angular 日本語版](https://angular.jp/cli/update#:~:text=%60allow))
- Angular 公式: アップデートガイド (v18 -> v19) ([Guide to update your Angular application v18.0](https://angular.dev/update-guide?v=18.0-19.0&l=1#:~:text=In%20the%20application%27s%20project%20directory%2C,Angular%20directives))
- Angular 公式ブログ: "Meet Angular v19" ([Meet Angular v19. In the past two years we doubled down… | by Minko Gechev | Angular Blog](https://blog.angular.dev/meet-angular-v19-7b29dfd05b84#:~:text=,addressing%20feature%20requests%20with%20more)) ([Meet Angular v19. In the past two years we doubled down… | by Minko Gechev | Angular Blog](https://blog.angular.dev/meet-angular-v19-7b29dfd05b84#:~:text=,HMR%20for%20styles%2C%20and%20more))
- Angular Minds ブログ: "Angular v19 Released: Top Features and Updates" ([Angular v19 Released: Top Features and Updates](https://www.angularminds.com/blog/angular-19-features#:~:text=Angular%20is%20now%20focusing%20on,enabled%20by%20default%2C%20and%20more)) ([What's New in Angular 19: Top Features and Updates](https://www.unifiedinfotech.net/blog/angular-19-new-features-a-steady-step-forward-or-just-another-update/#:~:text=In%20earlier%20versions%20of%20Angular,each%20individual%20route%20is%20rendered))
- lacolaco 氏ブログ: "Angular プロジェクトのための Renovate 設定"（ng update の解説） ([Angular プロジェクトのための Renovate 設定 | lacolaco's marginalia](https://blog.lacolaco.net/posts/renovate-config-for-angular-cli/#:~:text=,%E3%81%AF%E3%81%A8%E3%81%A6%E3%82%82%E9%87%8D%E8%A6%81%E3%81%AA%E5%BD%B9%E5%89%B2%E3%81%8C%E3%81%82%E3%82%8B%E3%80%82))
- StackOverflow: アップデート時のエラー対処例 ([typescript - Repository is not clean. Please commit or stash any changes before updating In Angular 8 - Stack Overflow](https://stackoverflow.com/questions/56773528/repository-is-not-clean-please-commit-or-stash-any-changes-before-updating-in-a#:~:text=I%27ve%20had%20the%20same%20issue,bypass%20this%2C%20follow%20force%20commands))
